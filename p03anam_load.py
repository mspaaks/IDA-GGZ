import pandas as pd
import numpy as np
from replace_missing import replace_missing7 
from replace_missing import replace_missing6
from replace_missing import replace_missing2
from replace_missing import replace_missing 

path_p03anam13 = r'C:\Users\marij\OneDrive\Documenten\TM Jaar 2\TM Stage IDA\p03anam13_2022-01-25.csv'
path_p03anam14 = r'C:\Users\marij\OneDrive\Documenten\TM Jaar 2\TM Stage IDA\p03anam14_2022-01-25.csv'
path_p03anam15 = r'C:\Users\marij\OneDrive\Documenten\TM Jaar 2\TM Stage IDA\p03anam15_2022-01-25.csv'
path_p03anam16 = r'C:\Users\marij\OneDrive\Documenten\TM Jaar 2\TM Stage IDA\p03anam16_2022-01-25.csv'
path_p03anam18 = r'C:\Users\marij\OneDrive\Documenten\TM Jaar 2\TM Stage IDA\p03anam18_2022-01-25.csv'
path_p03anam19 = r'C:\Users\marij\OneDrive\Documenten\TM Jaar 2\TM Stage IDA\p03anam19_2022-01-25.csv'
path_p03anam22 = r'C:\Users\marij\OneDrive\Documenten\TM Jaar 2\TM Stage IDA\p03anam22_2022-01-25.csv'

df_p03anam13 = pd.read_csv(path_p03anam13, sep=';')
df_p03anam14 = pd.read_csv(path_p03anam14, sep=';')
df_p03anam15 = pd.read_csv(path_p03anam15, sep=';')
df_p03anam16 = pd.read_csv(path_p03anam16, sep=';')
df_p03anam18 = pd.read_csv(path_p03anam18, sep=';')
df_p03anam19 = pd.read_csv(path_p03anam19, sep=';')
df_p03anam22 = pd.read_csv(path_p03anam22, sep=';')

df_p03anam13 = df_p03anam13.drop(columns={'gender', 'birth_year', 'roqua_id','hide_pii_from_researchers', 'hide_values_from_professionals', 'respondent_id', 'respondent_type', 'respondent_label','p03anam13_id','p03anam13_protocol','p03anam13_project','p03anam13_measurement','p03anam13_notes', 'p03anam13_location','p03anam13_invited_at','p03anam13_emailed_at','p03anam13_open_from','p03anam13_non_response','p03anam13_compl_by', 'p03anam13_started_at','p03anam13_completed_at','p03anam13_variant','p03anam13_anonymous','p03anam13_257','p03anam13_285','p03anam13_286','p03anam13_287','p03anam13_262','p03anam13_289','p03anam13_263','p03anam13_264','p03anam13_265','p03anam13_266','p03anam13_257','p03anam13_290','p03anam13_284','p03anam13_294','p03anam13_295','p03anam13_259','p03anam13_258','p03anam13_2','p03anam13_260','p03anam13_268','p03anam13_269','p03anam13_278','p03anam13_279','p03anam13_276','p03anam13_277','p03anam13_296','p03anam13_282','p03anam13_297'})
df_p03anam14 = df_p03anam14.drop(columns={'gender', 'birth_year', 'roqua_id','hide_pii_from_researchers', 'hide_values_from_professionals', 'respondent_id', 'respondent_type', 'respondent_label','p03anam14_id','p03anam14_protocol','p03anam14_project','p03anam14_measurement','p03anam14_notes', 'p03anam14_location','p03anam14_invited_at','p03anam14_emailed_at','p03anam14_open_from','p03anam14_non_response','p03anam14_compl_by', 'p03anam14_started_at','p03anam14_completed_at','p03anam14_variant','p03anam14_anonymous','p03anam14_257','p03anam14_286','p03anam14_287','p03anam14_257','p03anam14_262','p03anam14_289','p03anam14_263','p03anam14_264','p03anam14_265_a_10','p03anam14_265_a_20','p03anam14_265_a_30','p03anam14_265_a_40','p03anam14_265_a_50','p03anam14_265_a_60','p03anam14_265_a_70','p03anam14_265_a_80','p03anam14_265_a_90','p03anam14_290','p03anam14_284','p03anam14_294','p03anam14_295','p03anam14_278','p03anam14_279','p03anam14_276','p03anam14_277','p03anam14_296','p03anam14_282','p03anam14_297','p03anam14_259','p03anam14_258','p03anam14_2','p03anam14_260','p03anam14_285','p03anam14_268','p03anam14_269','p03anam14_280'})
df_p03anam15 = df_p03anam15.drop(columns={'gender', 'birth_year', 'roqua_id','hide_pii_from_researchers', 'hide_values_from_professionals', 'respondent_id', 'respondent_type', 'respondent_label','p03anam15_id','p03anam15_protocol','p03anam15_project','p03anam15_measurement','p03anam15_notes', 'p03anam15_location','p03anam15_invited_at','p03anam15_emailed_at','p03anam15_open_from','p03anam15_non_response','p03anam15_compl_by', 'p03anam15_started_at','p03anam15_completed_at','p03anam15_variant','p03anam15_anonymous','p03anam15_257','p03anam15_257o','p03anam15_257o_01','p03anam15_284','p03anam15_294','p03anam15_295','p03anam15_300','p03anam15_301','p03anam15_302','p03anam15_262','p03anam15_303','p03anam15_304','p03anam15_305','p03anam15_306','p03anam15_296','p03anam15_282','p03anam15_297','p03anam15_307a','p03anam15_307b','p03anam15_307c','p03anam15_307','p03anam15_269','p03anam15_268','p03anam15_257_01','p03anam15_257b','p03anam15_245b','p03anam15_1275b','p03anam15_242bz','p03anam15_257o_01','p03anam15_257o','p03anam15_245o','p03anam15_1275o','p03anam15_308','p03anam15_258','p03anam15_2','p03anam15_257b_01'})
df_p03anam16 = df_p03anam16.drop(columns={'gender', 'birth_year', 'roqua_id','hide_pii_from_researchers', 'hide_values_from_professionals', 'respondent_id', 'respondent_type', 'respondent_label','p03anam16_id','p03anam16_protocol','p03anam16_project','p03anam16_measurement','p03anam16_notes', 'p03anam16_location','p03anam16_invited_at','p03anam16_emailed_at','p03anam16_open_from','p03anam16_non_response','p03anam16_compl_by', 'p03anam16_started_at','p03anam16_completed_at','p03anam16_variant','p03anam16_anonymous','p03anam16_257','p03anam16_257_01','p03anam16_257','p03anam16_284','p03anam16_294','p03anam16_295','p03anam16_300','p03anam16_301','p03anam16_302','p03anam16_262','p03anam16_303','p03anam16_304','p03anam16_305','p03anam16_306','p03anam16_307a','p03anam16_307b','p03anam16_307c','p03anam16_282','p03anam16_297','p03anam16_284','p03anam16_294','p03anam16_295','p03anam16_268','p03anam16_269','p03anam16_296','p03anam16_308','p03anam16_2','p03anam16_258','p03anam16_257b_01','p03anam16_257','p03anam16_257b','p03anam16_245b','p03anam16_1275b','p03anam16_242bz','p03anam16_257o_01','p03anam16_257o','p03anam16_245o','p03anam16_1275o','p03anam16_307'})
df_p03anam18 = df_p03anam18.drop(columns={'gender', 'birth_year', 'roqua_id','hide_pii_from_researchers', 'hide_values_from_professionals', 'respondent_id', 'respondent_type', 'respondent_label','p03anam18_id','p03anam18_protocol','p03anam18_project','p03anam18_measurement','p03anam18_notes', 'p03anam18_location','p03anam18_invited_at','p03anam18_emailed_at','p03anam18_open_from','p03anam18_non_response','p03anam18_compl_by', 'p03anam18_started_at','p03anam18_completed_at','p03anam18_variant','p03anam18_anonymous','p03anam18_257','p03anam18_257','p03anam18_284','p03anam18_294','p03anam18_295','p03anam18_300','p03anam18_301','p03anam18_302','p03anam18_262','p03anam18_303','p03anam18_304','p03anam18_305','p03anam18_306','p03anam18_307a','p03anam18_307b','p03anam18_307c','p03anam18_307d','p03anam18_269','p03anam18_296','p03anam18_308','p03anam18_2','p03anam18_258','p03anam18_257b_01','p03anam18_257','p03anam18_257b','p03anam18_245b','p03anam18_1275b','p03anam18_242bz','p03anam18_257o_01','p03anam18_257o','p03anam18_245o','p03anam18_1275o','p03anam18_297','p03anam18_282','p03anam18_268','p03anam18_307','p03anam18_257_01'})
df_p03anam19 = df_p03anam19.drop(columns={'gender', 'birth_year', 'roqua_id','hide_pii_from_researchers', 'hide_values_from_professionals', 'respondent_id', 'respondent_type', 'respondent_label','p03anam19_id','p03anam19_protocol','p03anam19_project','p03anam19_measurement','p03anam19_notes', 'p03anam19_location','p03anam19_invited_at','p03anam19_emailed_at','p03anam19_open_from','p03anam19_non_response','p03anam19_compl_by', 'p03anam19_started_at','p03anam19_completed_at','p03anam19_variant','p03anam19_anonymous','p03anam19_257','p03anam19_257','p03anam19_284','p03anam19_294','p03anam19_295','p03anam19_300','p03anam19_301','p03anam19_302','p03anam19_262','p03anam19_303','p03anam19_304','p03anam19_305','p03anam19_306','p03anam19_306a','p03anam19_307a','p03anam19_307b','p03anam19_307c','p03anam19_307d','p03anam19_296','p03anam19_282','p03anam19_297','p03anam19_308','p03anam19_307a2','p03anam19_307c2','p03anam19_307','p03anam19_269','p03anam19_268','p03anam19_267b','p03anam19_267a','p03anam19_257o','p03anam19_245o','p03anam19_1275o','p03anam19_296','p03anam19_282','p03anam19_297','p03anam19_308','p03anam19_307a2','p03anam19_307c2','p03anam19_307','p03anam19_269','p03anam19_268','p03anam19_267b','p03anam19_267a','p03anam19_257b','p03anam19_245b','p03anam19_1275b','p03anam19_297a','p03anam19_2','p03anam19_258','p03anam19_257b_01'})
df_p03anam22 = df_p03anam22.drop(columns={'gender', 'birth_year', 'roqua_id','hide_pii_from_researchers', 'hide_values_from_professionals', 'respondent_id', 'respondent_type', 'respondent_label','p03anam22_id','p03anam22_protocol','p03anam22_project','p03anam22_measurement','p03anam22_notes', 'p03anam22_location','p03anam22_invited_at','p03anam22_emailed_at','p03anam22_open_from','p03anam22_non_response','p03anam22_compl_by', 'p03anam22_started_at','p03anam22_completed_at','p03anam22_variant','p03anam22_anonymous','p03anam22_300','p03anam22_301','p03anam22_302','p03anam22_262','p03anam22_303','p03anam22_304','p03anam22_305','p03anam22_306','p03anam22_306a','p03anam22_258','p03anam22_2'})

df_p03anam13 = df_p03anam13.rename(columns={'p03anam13_date': 'Date','p03anam13_241':'No disease','p03anam13_242':'Diabetes','p03anam13_243':'High cholesterol','p03anam13_244':'Cardiovascular disease','p03anam13_1273':'Obesity','p03anam13_1274':'Epilepsy','p03anam13_1275':'Thyroid disorder','p03anam13_245':'Osteoporosis','p03anam13_1075':'Diabetes parents','p03anam13_1076':'Diabetes brother/sister','p03anam13_1077':'High chol. parents','p03anam13_1078':'High chol. brother/sister','p03anam13_1079':'Cardiovascular dis. parents','p03anam13_1080':'Cardiovascular dis. broth/sis','p03anam13_1081':'Obesity parents','p03anam13_1082':'Obesity broth/sis','p03anam13_1083':'Osteop. parents','p03anam13_1084':'Osteop. broth/sis','p03anam13_291':'Vit D suppl','p03anam13_292':'Calcium suppl','p03anam13_267':'Alcohol','p03anam13_275':'Smoking','p03anam13_281':'Cannabis','p03anam13_283':'Drugs'})
df_p03anam14 = df_p03anam14.rename(columns={'p03anam14_date': 'Date','p03anam14_241':'No disease','p03anam14_242':'Diabetes','p03anam14_243':'High cholesterol','p03anam14_244':'Cardiovascular disease','p03anam14_1273':'Obesity','p03anam14_1274':'Epilepsy','p03anam14_1275':'Thyroid disorder','p03anam14_245':'Osteoporosis','p03anam14_1075':'Diabetes parents','p03anam14_1076':'Diabetes brother/sister','p03anam14_1077':'High chol. parents','p03anam14_1078':'High chol. brother/sister','p03anam14_1079':'Cardiovascular dis. parents','p03anam14_1080':'Cardiovascular dis. broth/sis','p03anam14_1081':'Obesity parents','p03anam14_1082':'Obesity broth/sis','p03anam14_1083':'Osteop. parents','p03anam14_1084':'Osteop. broth/sis','p03anam14_291':'Vit D suppl','p03anam14_292':'Calcium suppl','p03anam14_267':'Alcohol','p03anam14_275':'Smoking','p03anam14_281':'Cannabis','p03anam14_283':'Drugs'})
df_p03anam15 = df_p03anam15.rename(columns={'p03anam15_date': 'Date','p03anam15_242':'Diabetes','p03anam15_243':'High cholesterol','p03anam15_244':'Cardiovascular disease','p03anam15_1273':'Obesity','p03anam15_1274':'Epilepsy','p03anam15_1275':'Thyroid disorder','p03anam15_245':'Osteoporosis','p03anam15_242o':'Diabetes parents','p03anam15_242b':'Diabetes brother/sister','p03anam15_243o':'High chol. parents','p03anam15_243b':'High chol. brother/sister','p03anam15_244o':'Cardiovascular dis. parents','p03anam15_244b':'Cardiovascular dis. broth/sis','p03anam15_1273o':'Obesity parents','p03anam15_1273b':'Obesity broth/sis','p03anam15_1274o':'Osteop. parents','p03anam15_1274b':'Osteop. broth/sis','p03anam15_291':'Vit D suppl','p03anam15_292':'Calcium suppl','p03anam15_267':'Alcohol','p03anam15_275':'Smoking','p03anam15_281':'Cannabis','p03anam15_283':'Drugs'})
df_p03anam16 = df_p03anam16.rename(columns={'p03anam16_date': 'Date','p03anam16_242':'Diabetes','p03anam16_243':'High cholesterol','p03anam16_244':'Cardiovascular disease','p03anam16_1273':'Obesity','p03anam16_1274':'Epilepsy','p03anam16_1275':'Thyroid disorder','p03anam16_245':'Osteoporosis','p03anam16_242o':'Diabetes parents','p03anam16_242b':'Diabetes brother/sister','p03anam16_243o':'High chol. parents','p03anam16_243b':'High chol. brother/sister','p03anam16_244o':'Cardiovascular dis. parents','p03anam16_244b':'Cardiovascular dis. broth/sis','p03anam16_1273o':'Obesity parents','p03anam16_1273b':'Obesity broth/sis','p03anam16_1274o':'Osteop. parents','p03anam16_1274b':'Osteop. broth/sis','p03anam16_291':'Vit D suppl','p03anam16_292':'Calcium suppl','p03anam16_267':'Alcohol','p03anam16_275':'Smoking','p03anam16_281':'Cannabis','p03anam16_283':'Drugs'})
df_p03anam18 = df_p03anam18.rename(columns={'p03anam18_date': 'Date','p03anam18_242':'Diabetes','p03anam18_243':'High cholesterol','p03anam18_244':'Cardiovascular disease','p03anam18_1273':'Obesity','p03anam18_1274':'Epilepsy','p03anam18_1275':'Thyroid disorder','p03anam18_245':'Osteoporosis','p03anam18_242o':'Diabetes parents','p03anam18_242b':'Diabetes brother/sister','p03anam18_243o':'High chol. parents','p03anam18_243b':'High chol. brother/sister','p03anam18_244o':'Cardiovascular dis. parents','p03anam18_244b':'Cardiovascular dis. broth/sis','p03anam18_1273o':'Obesity parents','p03anam18_1273b':'Obesity broth/sis','p03anam18_1274o':'Osteop. parents','p03anam18_1274b':'Osteop. broth/sis','p03anam18_291':'Vit D suppl','p03anam18_292':'Calcium suppl','p03anam18_267':'Alcohol','p03anam18_275':'Smoking','p03anam18_281':'Cannabis','p03anam18_283':'Drugs'})
df_p03anam19 = df_p03anam19.rename(columns={'p03anam19_date': 'Date','p03anam19_242':'Diabetes','p03anam19_243':'High cholesterol','p03anam19_244':'Cardiovascular disease','p03anam19_1273':'Obesity','p03anam19_1274':'Epilepsy','p03anam19_1275':'Thyroid disorder','p03anam19_245':'Osteoporosis','p03anam19_242o':'Diabetes parents','p03anam19_242b':'Diabetes brother/sister','p03anam19_243o':'High chol. parents','p03anam19_243b':'High chol. brother/sister','p03anam19_244o':'Cardiovascular dis. parents','p03anam19_244b':'Cardiovascular dis. broth/sis','p03anam19_1273o':'Obesity parents','p03anam19_1273b':'Obesity broth/sis','p03anam19_1274o':'Osteop. parents','p03anam19_1274b':'Osteop. broth/sis','p03anam19_291':'Vit D suppl','p03anam19_292':'Calcium suppl','p03anam19_267':'Alcohol','p03anam19_275':'Smoking','p03anam19_281':'Cannabis','p03anam19_283':'Drugs'})
df_p03anam22 = df_p03anam22.rename(columns={'p03anam22_date': 'Date','p03anam22_291':'Vit D suppl','p03anam22_292':'Calcium suppl'})

df_p03anam13['Date']= pd.to_datetime(df_p03anam13['Date'], format='%d-%m-%Y %H:%M:%S')
df_p03anam13 = df_p03anam13.sort_values(by="Date") 
df_p03anam13 = df_p03anam13.drop_duplicates("patient_id", keep='first')
df_p03anam14['Date']= pd.to_datetime(df_p03anam14['Date'], format='%d-%m-%Y %H:%M:%S')
df_p03anam14 = df_p03anam14.sort_values(by="Date") 
df_p03anam14 = df_p03anam14.drop_duplicates("patient_id", keep='first')
df_p03anam15['Date']= pd.to_datetime(df_p03anam15['Date'], format='%d-%m-%Y %H:%M:%S')
df_p03anam15 = df_p03anam15.sort_values(by="Date") 
df_p03anam15 = df_p03anam15.drop_duplicates("patient_id", keep='first')
df_p03anam16['Date']= pd.to_datetime(df_p03anam16['Date'], format='%d-%m-%Y %H:%M:%S')
df_p03anam16 = df_p03anam16.sort_values(by="Date") 
df_p03anam16 = df_p03anam16.drop_duplicates("patient_id", keep='first')
df_p03anam18['Date']= pd.to_datetime(df_p03anam18['Date'], format='%d-%m-%Y %H:%M:%S')
df_p03anam18 = df_p03anam18.sort_values(by="Date") 
df_p03anam18 = df_p03anam18.drop_duplicates("patient_id", keep='first')
df_p03anam19['Date']= pd.to_datetime(df_p03anam19['Date'], format='%d-%m-%Y %H:%M:%S')
df_p03anam19 = df_p03anam19.sort_values(by="Date") 
df_p03anam19 = df_p03anam19.drop_duplicates("patient_id", keep='first')
df_p03anam22['Date']= pd.to_datetime(df_p03anam22['Date'], format='%d-%m-%Y %H:%M:%S')
df_p03anam22 = df_p03anam22.sort_values(by="Date") 
df_p03anam22 = df_p03anam22.drop_duplicates("patient_id", keep='first')

df_p03anam_merge = df_p03anam13.merge(df_p03anam14, on='patient_id', how='outer', suffixes=('13', '14'))
df_p03anam_merge = df_p03anam_merge.merge(df_p03anam15, on='patient_id', how='outer', suffixes=('', '15'))
df_p03anam_merge = df_p03anam_merge.merge(df_p03anam16, on='patient_id', how='outer', suffixes=('15', '16'))
df_p03anam_merge = df_p03anam_merge.merge(df_p03anam18, on='patient_id', how='outer', suffixes=('16', '18'))
df_p03anam_merge = df_p03anam_merge.merge(df_p03anam19, on='patient_id', how='outer', suffixes=('18', '19'))
df_p03anam_merge = df_p03anam_merge.merge(df_p03anam22, on='patient_id', how='outer', suffixes=('19', '22'))
df_p03anam_merger = df_p03anam_merge.replace('>', '', regex=True).replace('<', '', regex=True)

df_p03anam_merger["Diabetes_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Diabetes13'], x["Diabetes14"], x['Diabetes15'], x["Diabetes16"], x["Diabetes18"], x["Diabetes19"]), axis = 1)
df_p03anam_merger["High_cholesterol_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['High cholesterol13'], x["High cholesterol14"], x['High cholesterol15'], x["High cholesterol16"], x["High cholesterol18"], x["High cholesterol19"]), axis = 1)
df_p03anam_merger["Cardiovascular_disease_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Cardiovascular disease13'], x["Cardiovascular disease14"], x['Cardiovascular disease15'], x["Cardiovascular disease16"], x["Cardiovascular disease18"], x["Cardiovascular disease19"]), axis = 1)
df_p03anam_merger["Obesity_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Obesity13'], x["Obesity14"], x['Obesity15'], x["Obesity16"], x["Obesity18"], x["Obesity19"]), axis = 1)
df_p03anam_merger["Epilepsy_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Epilepsy13'], x["Epilepsy14"], x['Epilepsy15'], x["Epilepsy16"], x["Epilepsy18"], x["Epilepsy19"]), axis = 1)
df_p03anam_merger["Thyroid_disorder_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Thyroid disorder13'], x["Thyroid disorder14"], x['Thyroid disorder15'], x["Thyroid disorder16"], x["Thyroid disorder18"], x["Thyroid disorder19"]), axis = 1)
df_p03anam_merger["Osteoporosis_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Osteoporosis13'], x["Osteoporosis14"], x['Osteoporosis15'], x["Osteoporosis16"], x["Osteoporosis18"], x["Osteoporosis19"]), axis = 1)
df_p03anam_merger["Diabetes_parents_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Diabetes parents13'], x["Diabetes parents14"], x['Diabetes parents15'], x['Diabetes parents16'],x["Diabetes parents18"], x["Diabetes parents19"]), axis = 1)
df_p03anam_merger["Diabetes_brother/sister_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Diabetes brother/sister13'], x["Diabetes brother/sister14"], x['Diabetes brother/sister15'], x["Diabetes brother/sister16"], x["Diabetes brother/sister18"], x["Diabetes brother/sister19"]), axis = 1)
df_p03anam_merger["High_chol_parents_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['High chol. parents13'], x["High chol. parents14"], x['High chol. parents15'], x["High chol. parents16"], x["High chol. parents18"], x["High chol. parents19"]), axis = 1)
df_p03anam_merger["High_chol_brother/sister_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['High chol. brother/sister13'], x["High chol. brother/sister14"], x['High chol. brother/sister15'], x["High chol. brother/sister16"], x["High chol. brother/sister18"], x["High chol. brother/sister19"]), axis = 1)
df_p03anam_merger["Cardiovascular_dis_parents_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Cardiovascular dis. parents13'], x["Cardiovascular dis. parents14"], x['Cardiovascular dis. parents15'], x["Cardiovascular dis. parents16"], x["Cardiovascular dis. parents18"], x["Cardiovascular dis. parents19"]), axis = 1)
df_p03anam_merger["Cardiovascular_dis_broth/sis_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Cardiovascular dis. broth/sis13'], x["Cardiovascular dis. broth/sis14"], x['Cardiovascular dis. broth/sis15'], x["Cardiovascular dis. broth/sis16"], x["Cardiovascular dis. broth/sis18"], x["Cardiovascular dis. broth/sis19"]), axis = 1)
df_p03anam_merger["Obesity_parents_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Obesity parents13'], x["Obesity parents14"], x['Obesity parents15'], x["Obesity parents16"], x["Obesity parents18"], x["Obesity parents19"]), axis = 1)
df_p03anam_merger["Obesity_broth/sis_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Obesity broth/sis13'], x["Obesity broth/sis14"], x['Obesity broth/sis15'], x["Obesity broth/sis16"], x["Obesity broth/sis18"], x["Obesity broth/sis19"]), axis = 1)
df_p03anam_merger["Osteop_parents_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Osteop. parents13'], x["Osteop. parents14"], x['Osteop. parents15'], x["Osteop. parents16"], x["Osteop. parents18"], x["Osteop. parents19"]), axis = 1)
df_p03anam_merger["Osteop_broth/sis_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Osteop. broth/sis13'], x["Osteop. broth/sis14"], x['Osteop. broth/sis15'], x["Osteop. broth/sis16"], x["Osteop. broth/sis18"], x["Osteop. broth/sis19"]), axis = 1)
df_p03anam_merger["VitD_suppl_all"] = df_p03anam_merger.apply(lambda x: replace_missing7(x['Vit D suppl13'], x["Vit D suppl14"], x['Vit D suppl15'], x["Vit D suppl16"], x["Vit D suppl18"], x["Vit D suppl19"], x["Vit D suppl"]), axis = 1)
df_p03anam_merger["Calcium_suppl_all"] = df_p03anam_merger.apply(lambda x: replace_missing7(x['Calcium suppl13'], x["Calcium suppl14"], x['Calcium suppl15'], x["Calcium suppl16"], x["Calcium suppl18"], x["Calcium suppl19"], x["Calcium suppl"]), axis = 1)
df_p03anam_merger["Alcohol_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Alcohol13'], x["Alcohol14"], x['Alcohol15'], x["Alcohol16"], x["Alcohol18"], x["Alcohol19"]), axis = 1)
df_p03anam_merger["Smoking_all"] = df_p03anam_merger.apply(lambda x: replace_missing2(x['Smoking13'], x["Smoking14"]), axis = 1)
df_p03anam_merger["Cannabis_all"] = df_p03anam_merger.apply(lambda x: replace_missing6(x['Cannabis13'], x["Cannabis14"], x['Cannabis15'], x["Cannabis16"], x["Cannabis18"], x["Cannabis19"]), axis = 1)
df_p03anam_merger["Drugs_all"] = df_p03anam_merger.apply(lambda x: replace_missing(x["Drugs14"], x['Drugs15'], x["Drugs16"], x["Drugs18"], x["Drugs19"]), axis = 1)

#Remove individual columns and only keep combined column
df_p03anam = df_p03anam_merger[['patient_id','Diabetes_all','High_cholesterol_all','Cardiovascular_disease_all','Obesity_all','Epilepsy_all','Thyroid_disorder_all','Osteoporosis_all','Diabetes_parents_all','Diabetes_brother/sister_all','High_chol_parents_all','High_chol_brother/sister_all','Cardiovascular_dis_parents_all','Cardiovascular_dis_broth/sis_all','Obesity_parents_all','Obesity_broth/sis_all','Osteop_parents_all','Osteop_broth/sis_all','VitD_suppl_all','Calcium_suppl_all','Alcohol_all','Smoking_all','Cannabis_all','Drugs_all']]

#Create a file containing the relevant variables 
df_p03anam.to_csv('df_p03anam.csv')
import pandas as pd
import numpy as np
from replace_missing import replace_missing2, replace_missing4
from replace_missing import replace_missing7 
from replace_missing import replace_missing6
from replace_missing import replace_missing

# Loading the data, define the necessary path  
path_p02psyf13 = r'C:\Users\marij\OneDrive\Documenten\TM Jaar 2\TM Stage IDA\p02psyf13_2022-01-25.csv'
path_p02psyf14 = r'C:\Users\marij\OneDrive\Documenten\TM Jaar 2\TM Stage IDA\p02psyf14_2022-01-25.csv'
path_p02psyf15 = r'C:\Users\marij\OneDrive\Documenten\TM Jaar 2\TM Stage IDA\p02psyf15_2022-01-25.csv'
path_p02psyf16 = r'C:\Users\marij\OneDrive\Documenten\TM Jaar 2\TM Stage IDA\p02psyf16_2022-01-25.csv'
path_p02psyf18 = r'C:\Users\marij\OneDrive\Documenten\TM Jaar 2\TM Stage IDA\p02psyf18_2022-01-25.csv'
path_p02psyf19 = r'C:\Users\marij\OneDrive\Documenten\TM Jaar 2\TM Stage IDA\p02psyf19_2022-01-25.csv'
path_p02psyf20 = r'C:\Users\marij\OneDrive\Documenten\TM Jaar 2\TM Stage IDA\p02psyf20_2022-01-25.csv'

df_p02psyf13 = pd.read_csv(path_p02psyf13, sep=';')
df_p02psyf14 = pd.read_csv(path_p02psyf14, sep=';')
df_p02psyf15 = pd.read_csv(path_p02psyf15, sep=';')
df_p02psyf16 = pd.read_csv(path_p02psyf16, sep=';')
df_p02psyf18 = pd.read_csv(path_p02psyf18, sep=';')
df_p02psyf19 = pd.read_csv(path_p02psyf19, sep=';')
df_p02psyf20 = pd.read_csv(path_p02psyf20, sep=';')

# Dropping irrelevant columns
df_p02psyf13 = df_p02psyf13.drop(columns={'gender', 'birth_year', 'roqua_id','hide_pii_from_researchers', 'hide_values_from_professionals', 'respondent_id', 'respondent_type', 'respondent_label','p02psyf13_id','p02psyf13_protocol','p02psyf13_project','p02psyf13_measurement','p02psyf13_notes', 'p02psyf13_location','p02psyf13_invited_at','p02psyf13_emailed_at','p02psyf13_open_from','p02psyf13_non_response','p02psyf13_compl_by', 'p02psyf13_started_at','p02psyf13_completed_at','p02psyf13_variant','p02psyf13_anonymous','p02psyf13_pf1_1283','p02psyf13_pf1_1284','p02psyf13_pf1_1293','p02psyf13_pf1_1295','p02psyf13_pf1_1294','p02psyf13_pf1_1296','p02psyf13_pf1_1297','p02psyf13_pf1_1298','p02psyf13_pf1_1299','p02psyf13_pf2_1294','p02psyf13_pf1_1295','p02psyf13_pf2_207','p02psyf13_pf2_1303','p02psyf13_pf2_1304','p02psyf13_pf3_240','p02psyf13_pf3_1068','p02psyf13_pf3_1070','p02psyf13_pf2_211','p02psyf13_pf2_1067','p02psyf13_pf2_1295','p02psyf13_pf2_1293','p02psyf13_pf3_241','p02psyf13_pf3_1069','p02psyf13_pf3_1071'})
df_p02psyf14 = df_p02psyf14.drop(columns={'gender', 'birth_year', 'roqua_id','hide_pii_from_researchers', 'hide_values_from_professionals', 'respondent_id', 'respondent_type', 'respondent_label','p02psyf14_id','p02psyf14_protocol','p02psyf14_project','p02psyf14_measurement','p02psyf14_notes', 'p02psyf14_location','p02psyf14_invited_at','p02psyf14_emailed_at','p02psyf14_open_from','p02psyf14_non_response','p02psyf14_compl_by', 'p02psyf14_started_at','p02psyf14_completed_at','p02psyf14_variant','p02psyf14_anonymous','p02psyf14_pf1_1283','p02psyf14_pf1_1284','p02psyf14_pf1_1293','p02psyf14_pf1_1295','p02psyf14_pf1_1294','p02psyf14_pf1_1296','p02psyf14_pf1_1297','p02psyf14_pf1_1298','p02psyf14_pf1_1299','p02psyf14_pf2_1294','p02psyf14_pf2_1295','p02psyf14_pf2_207','p02psyf14_pf2_1303','p02psyf14_pf2_1304','p02psyf14_pf3_240','p02psyf14_pf3_1068','p02psyf14_pf3_1070','p02psyf14_pf2_211','p02psyf14_pf2_1067','p02psyf14_pf2_1295','p02psyf14_pf3_241','p02psyf14_pf3_1069','p02psyf14_pf3_1071'})
df_p02psyf15 = df_p02psyf15.drop(columns={'gender', 'birth_year', 'roqua_id','hide_pii_from_researchers', 'hide_values_from_professionals', 'respondent_id', 'respondent_type', 'respondent_label','p02psyf15_id','p02psyf15_protocol','p02psyf15_project','p02psyf15_measurement','p02psyf15_notes', 'p02psyf15_location','p02psyf15_invited_at','p02psyf15_emailed_at','p02psyf15_open_from','p02psyf15_non_response','p02psyf15_compl_by', 'p02psyf15_started_at','p02psyf15_completed_at','p02psyf15_variant','p02psyf15_anonymous','p02psyf15_pf1_100a','p02psyf15_pf1_1283','p02psyf15_pf1_1283_a29a','p02psyf15_pf1_100b','p02psyf15_pf1_1284_a2','p02psyf15_pf1_1284_a3','p02psyf15_pf1_1284_a4','p02psyf15_pf1_1284_a5','p02psyf15_pf1_1284_a6','p02psyf15_pf1_1284_a7','p02psyf15_pf1_1284_a8','p02psyf15_pf1_1284_a9','p02psyf15_pf1_1284_a10','p02psyf15_pf1_1284_a11','p02psyf15_pf1_1284_a12','p02psyf15_pf1_1284_a13','p02psyf15_pf1_1284_a14','p02psyf15_pf1_1284_a15','p02psyf15_pf1_1284_a16','p02psyf15_pf1_1284_a17','p02psyf15_pf1_1284_a18','p02psyf15_pf1_1284_a19','p02psyf15_pf1_1284_a20','p02psyf15_pf1_1284_a21','p02psyf15_pf1_1284_a22','p02psyf15_pf1_1284_a23','p02psyf15_pf1_1284_a24','p02psyf15_pf1_1284_a25','p02psyf15_pf1_1284_a26','p02psyf15_pf1_1284_a27','p02psyf15_pf1_1284_a28','p02psyf15_pf1_1284_a29','p02psyf15_pf1_1284_a29a','p02psyf15_pf1_101a','p02psyf15_pf1_1295_a2','p02psyf15_pf1_1295_a3','p02psyf15_pf1_1295_a4','p02psyf15_pf1_1295_a5','p02psyf15_pf1_1295_a6','p02psyf15_pf1_1295_a7','p02psyf15_pf1_1295_a8','p02psyf15_pf1_1295_a9','p02psyf15_pf1_1295_a10','p02psyf15_pf1_1295_a11','p02psyf15_pf1_1295_a12','p02psyf15_pf1_1295_a13','p02psyf15_pf1_1295_a14','p02psyf15_pf1_1295_a15','p02psyf15_pf1_1295_a15a','p02psyf15_pf1_102a','p02psyf15_pf1_1297_a2','p02psyf15_pf1_1297_a3','p02psyf15_pf1_1297_a4','p02psyf15_pf1_1297_a5','p02psyf15_pf1_1297_a6','p02psyf15_pf1_1297_a7','p02psyf15_pf1_1297_a8','p02psyf15_pf1_1297_a9','p02psyf15_pf1_1297_a10','p02psyf15_pf1_1297_a11','p02psyf15_pf1_1297_a12','p02psyf15_pf1_1297_a13','p02psyf15_pf1_1297_a14','p02psyf15_pf1_1297_a15','p02psyf15_pf1_1297_a16','p02psyf15_pf1_1297_a17','p02psyf15_pf1_1297_a18','p02psyf15_pf1_1297_a19','p02psyf15_pf1_1297_a20','p02psyf15_pf1_1297_a20a','p02psyf15_pf2_1294','p02psyf15_pf2_209_a6','p02psyf15_pf2_1067','p02psyf15_pf2_207','p02psyf15_pf2_211','p02psyf15_pf3_1293a1'})
df_p02psyf16 = df_p02psyf16.drop(columns={'gender', 'birth_year', 'roqua_id','hide_pii_from_researchers', 'hide_values_from_professionals', 'respondent_id', 'respondent_type', 'respondent_label','p02psyf16_id','p02psyf16_protocol','p02psyf16_project','p02psyf16_measurement','p02psyf16_notes', 'p02psyf16_location','p02psyf16_invited_at','p02psyf16_emailed_at','p02psyf16_open_from','p02psyf16_non_response','p02psyf16_compl_by', 'p02psyf16_started_at','p02psyf16_completed_at','p02psyf16_variant','p02psyf16_anonymous','p02psyf16_pf1_100a','p02psyf16_pf1_1283','p02psyf16_pf1_1283_a29a','p02psyf16_pf1_100b','p02psyf16_pf1_1284_a2','p02psyf16_pf1_1284_a3','p02psyf16_pf1_1284_a4','p02psyf16_pf1_1284_a5','p02psyf16_pf1_1284_a6','p02psyf16_pf1_1284_a7','p02psyf16_pf1_1284_a8','p02psyf16_pf1_1284_a9','p02psyf16_pf1_1284_a10','p02psyf16_pf1_1284_a11','p02psyf16_pf1_1284_a12','p02psyf16_pf1_1284_a13','p02psyf16_pf1_1284_a14','p02psyf16_pf1_1284_a15','p02psyf16_pf1_1284_a16','p02psyf16_pf1_1284_a17','p02psyf16_pf1_1284_a18','p02psyf16_pf1_1284_a19','p02psyf16_pf1_1284_a20','p02psyf16_pf1_1284_a21','p02psyf16_pf1_1284_a22','p02psyf16_pf1_1284_a23','p02psyf16_pf1_1284_a24','p02psyf16_pf1_1284_a25','p02psyf16_pf1_1284_a26','p02psyf16_pf1_1284_a27','p02psyf16_pf1_1284_a28','p02psyf16_pf1_1284_a29','p02psyf16_pf1_1284_a29a','p02psyf16_pf1_101a','p02psyf16_pf1_1295_a2','p02psyf16_pf1_1295_a3','p02psyf16_pf1_1295_a4','p02psyf16_pf1_1295_a5','p02psyf16_pf1_1295_a6','p02psyf16_pf1_1295_a7','p02psyf16_pf1_1295_a8','p02psyf16_pf1_1295_a9','p02psyf16_pf1_1295_a10','p02psyf16_pf1_1295_a11','p02psyf16_pf1_1295_a12','p02psyf16_pf1_1295_a13','p02psyf16_pf1_1295_a14','p02psyf16_pf1_1295_a15','p02psyf16_pf1_1295_a15a','p02psyf16_pf1_102a','p02psyf16_pf1_1297_a2','p02psyf16_pf1_1297_a3','p02psyf16_pf1_1297_a4','p02psyf16_pf1_1297_a5','p02psyf16_pf1_1297_a6','p02psyf16_pf1_1297_a7','p02psyf16_pf1_1297_a8','p02psyf16_pf1_1297_a9','p02psyf16_pf1_1297_a10','p02psyf16_pf1_1297_a11','p02psyf16_pf1_1297_a12','p02psyf16_pf1_1297_a13','p02psyf16_pf1_1297_a14','p02psyf16_pf1_1297_a15','p02psyf16_pf1_1297_a16','p02psyf16_pf1_1297_a17','p02psyf16_pf1_1297_a18','p02psyf16_pf1_1297_a19','p02psyf16_pf1_1297_a20','p02psyf16_pf1_1297_a20a','p02psyf16_pf2_1294','p02psyf16_pf2_209_a6','p02psyf16_pf2_1067','p02psyf16_pf2_207','p02psyf16_pf2_211','p02psyf16_pf3_1293a1'})
df_p02psyf18 = df_p02psyf18.drop(df_p02psyf18.iloc[:,23:452],axis = 1)
df_p02psyf18 = df_p02psyf18.drop(columns={'gender', 'birth_year', 'roqua_id','hide_pii_from_researchers', 'hide_values_from_professionals', 'respondent_id', 'respondent_type', 'respondent_label','p02psyf18_id','p02psyf18_protocol','p02psyf18_project','p02psyf18_measurement','p02psyf18_notes', 'p02psyf18_location','p02psyf18_invited_at','p02psyf18_emailed_at','p02psyf18_open_from','p02psyf18_non_response','p02psyf18_compl_by', 'p02psyf18_started_at','p02psyf18_completed_at'})
df_p02psyf19 = df_p02psyf19.drop(df_p02psyf19.iloc[:,23:473],axis = 1)
df_p02psyf19 = df_p02psyf19.drop(columns={'gender', 'birth_year', 'roqua_id','hide_pii_from_researchers', 'hide_values_from_professionals', 'respondent_id', 'respondent_type', 'respondent_label','p02psyf19_id','p02psyf19_protocol','p02psyf19_project','p02psyf19_measurement','p02psyf19_notes', 'p02psyf19_location','p02psyf19_invited_at','p02psyf19_emailed_at','p02psyf19_open_from','p02psyf19_non_response','p02psyf19_compl_by', 'p02psyf19_started_at','p02psyf19_completed_at','p02psyf19_pf3_1293a_a21','p02psyf19_pf3_1293a1','p02psyf19_pf2_207','p02psyf19_pf2_1067','p02psyf19_pf2_209_a6','p02psyf19_pf2_1295','p02psyf19_pf2_1294'})
df_p02psyf20 = df_p02psyf20.drop(df_p02psyf20.iloc[:,23:777],axis = 1)
df_p02psyf20 = df_p02psyf20.drop(columns={'gender', 'birth_year', 'roqua_id','hide_pii_from_researchers', 'hide_values_from_professionals', 'respondent_id', 'respondent_type', 'respondent_label','p02psyf20_id','p02psyf20_protocol','p02psyf20_project','p02psyf20_measurement','p02psyf20_notes', 'p02psyf20_location','p02psyf20_invited_at','p02psyf20_emailed_at','p02psyf20_open_from','p02psyf20_non_response','p02psyf20_compl_by', 'p02psyf20_started_at','p02psyf20_completed_at','p02psyf20_pf3_1293a_a21','p02psyf20_pf3_1293a1','p02psyf20_pf2_1307_a1','p02psyf20_pf2_1307_a1a','p02psyf20_pf2_1307_a2','p02psyf20_pf2_1307_a2a','p02psyf20_pf2_1307_a3','p02psyf20_pf2_1307_a3a','p02psyf20_pf2_1307_a4','p02psyf20_pf2_1307_a4a','p02psyf20_pf2_1307_a1','p02psyf20_pf2_1307_a5','p02psyf20_pf2_1307_a5a','p02psyf20_pf2_1307_a6','p02psyf20_pf2_1307_a6a','p02psyf20_pf2_1307_a7','p02psyf20_pf2_1307_a7a','p02psyf20_pf2_1307_a8a','p02psyf20_pf2_1307_a9','p02psyf20_pf2_1307_a9a','p02psyf20_80_a10a','p02psyf20_pf2_1307_a10','p02psyf20_pf2_1307_a10a','p02psyf20_pf2_1308_a1','p02psyf20_pf2_1308_a2','p02psyf20_pf2_1308_a3a','p02psyf20_pf2_1308_a4','p02psyf20_pf2_1308_a5','p02psyf20_pf2_1308_a5a','p02psyf20_pf2_1308_a6','p02psyf20_pf2_1308_a7','p02psyf20_pf2_1308_a8','p02psyf20_pf2_1308_a8a','p02psyf20_pf2_1308_a9','p02psyf20_pf2_1308_a10','p02psyf20_pf2_1308_a11','p02psyf20_pf2_1308_a11a','p02psyf20_pf2_1308_a12','p02psyf20_pf2_1308_a12a','p02psyf20_pf2_1308_a0','p02psyf20_pf2_1307_a0','p02psyf20_12_a1','p02psyf20_12_a1a','p02psyf20_12_a2','p02psyf20_12_a2a','p02psyf20_12_a3','p02psyf20_12_a3a','p02psyf20_12_a4','p02psyf20_12_a4a','p02psyf20_12_a5','p02psyf20_12_a5a','p02psyf20_12_a6','p02psyf20_12_a6a','p02psyf20_12_a7','p02psyf20_12_a7a','p02psyf20_12_a8a','p02psyf20_12a','p02psyf20_12a_a4a','p02psyf20_13','p02psyf20_9_a1','p02psyf20_9_a2','p02psyf20_9_a3','p02psyf20_9_a4','p02psyf20_9_a5','p02psyf20_9_a6','p02psyf20_9_a7','p02psyf20_9_a8','p02psyf20_9_a9','p02psyf20_9_a3a','p02psyf20_9_a5a','p02psyf20_9_a9a','p02psyf20_9_a9a3','p02psyf20_10','p02psyf20_14','p02psyf20_15','p02psyf20_9_a10','p02psyf20_9_a11','p02psyf20_9_a10a','p02psyf20_pf3_1290','p02psyf20_pf3_1294','p02psyf20_pf3_1292','p02psyf20_pf3_1293','p02psyf20_pf3_1284','p02psyf20_pf3_1285','p02psyf20_pf3_1298','p02psyf20_pf3_1291'})

# Renaming remaining columns
df_p02psyf13 = df_p02psyf13.rename(columns={'p02psyf13_date': 'Date','p02psyf13_pf2_1288':'psych complaint-free','p02psyf13_pf2_1289':'Psychosis','p02psyf13_pf2_1290':'Readmission','p02psyf13_pf2_1291':'Suicide attempt','p02psyf13_pf2_1292':'Judicial contacts','p02psyf13_pf2_208':'Ambulatory or inpatient','p02psyf13_pf2_210':'Living situation','p02psyf13_pf2_209':'Legal measure','p02psyf13_pf2_1298':'Paid work','p02psyf13_pf2_1299':'Protected work','p02psyf13_pf2_1300':'Voluntary work','p02psyf13_pf2_1301':'Study','p02psyf13_pf2_1302':'Household chores','p02psyf13_pf2_1305':'No daytime activities','p02psyf13_pf3_224':'Refused care','p02psyf13_pf3_1283':'Home care','p02psyf13_pf3_1280':'Nurse','p02psyf13_pf3_1281':'Psychiatrist','p02psyf13_pf3_225':'Cognitive behav. therapy','p02psyf13_pf3_1284':'Cognitive rehabilitation','p02psyf13_pf3_226':'Creative therapy','p02psyf13_pf3_1285':'Daytime activities center','p02psyf13_pf3_235':'Family intervention','p02psyf13_pf3_1074':'Peer group','p02psyf13_pf3_227':'Psycho education','p02psyf13_pf3_229':'Social skills training','p02psyf13_pf3_231':'Loss processing','p02psyf13_pf3_1286':'General rehabilitation','p02psyf13_pf3_234':'Lifestyle intervention','p02psyf13_pf3_238':'Occupational rehab.','p02psyf13_pf3_232':'Dealing with addiction','p02psyf13_pf3_237':'Financial support','p02psyf13_pf3_228':'Libermanmodule','p02psyf13_pf3_230':'Stressmanagement','p02psyf13_pf3_239':'Fitness/PMT','p02psyf13_pf3_1287':'GP for psych. problems','p02psyf13_pf3_1288':'GP for phys. problems','p02psyf13_pf3_1289':'Dentist'})
df_p02psyf14 = df_p02psyf14.rename(columns={'p02psyf14_date': 'Date','p02psyf14_pf2_1288':'psych complaint-free','p02psyf14_pf2_1289':'Psychosis','p02psyf14_pf2_1290':'Readmission','p02psyf14_pf2_1291':'Suicide attempt','p02psyf14_pf2_1292':'Judicial contacts','p02psyf14_pf2_208':'Ambulatory or inpatient','p02psyf14_pf2_212':'Education level','p02psyf14_pf2_210':'Living situation','p02psyf14_pf2_209_a7':'No legal measure','p02psyf14_pf2_209_a2':'Judicial authorization','p02psyf14_pf2_209_a3':'Detention','p02psyf14_pf2_209_a4':'Coercive treatment','p02psyf14_pf2_209_a5':'Observation','p02psyf14_pf2_209_a8':'TBS','p02psyf14_pf2_1298':'Paid work','p02psyf14_pf2_1299':'Protected work','p02psyf14_pf2_1300':'Voluntary work','p02psyf14_pf2_1301':'Study','p02psyf14_pf2_1302':'Household chores','p02psyf14_pf2_1305':'No daytime activities','p02psyf14_pf3_224':'Refused care','p02psyf14_pf3_1283':'Home care','p02psyf14_pf3_1280':'Nurse','p02psyf14_pf3_1281':'Psychiatrist','p02psyf14_pf3_225':'Cognitive behav. therapy','p02psyf14_pf3_1284':'Cognitive rehabilitation','p02psyf14_pf3_226':'Creative therapy','p02psyf14_pf3_1285':'Daytime activities center','p02psyf14_pf3_235':'Family intervention','p02psyf14_pf3_1074':'Peer group','p02psyf14_pf3_227':'Psycho education','p02psyf14_pf3_229':'Social skills training','p02psyf14_pf3_231':'Loss processing','p02psyf14_pf3_1286':'General rehabilitation','p02psyf14_pf3_234':'Lifestyle intervention','p02psyf14_pf3_238':'Occupational rehab.','p02psyf14_pf3_232':'Dealing with addiction','p02psyf14_pf3_237':'Financial support','p02psyf14_pf3_228':'Libermanmodule','p02psyf14_pf3_230':'Stressmanagement','p02psyf14_pf3_239':'Fitness/PMT','p02psyf14_pf3_1287':'GP for psych. problems','p02psyf14_pf3_1288':'GP for phys. problems','p02psyf14_pf3_1289':'Dentist'})
df_p02psyf15 = df_p02psyf15.rename(columns={'p02psyf15_date': 'Date','p02psyf15_pf2_1288':'psych complaint-free','p02psyf15_pf2_1289':'Psychosis','p02psyf15_pf2_1290':'Readmission','p02psyf15_pf2_1291':'Suicide attempt','p02psyf15_pf2_1292':'Judicial contacts','p02psyf15_pf2_208':'Ambulatory or inpatient','p02psyf15_pf2_210':'Living situation','p02psyf15_pf2_209_a7':'No legal measure','p02psyf15_pf2_209_a2':'Judicial authorization','p02psyf15_pf2_209_a3':'Detention','p02psyf15_pf2_209_a4':'Coercive treatment','p02psyf15_pf2_209_a5':'Observation','p02psyf15_pf2_209_a8':'TBS','p02psyf15_pf2_1298':'Paid work','p02psyf15_pf2_1299':'Protected work','p02psyf15_pf2_1300':'Voluntary work','p02psyf15_pf2_1301':'Study','p02psyf15_pf2_1302':'Household chores','p02psyf15_pf2_1305':'No daytime activities','p02psyf15_pf3_224':'Refused care','p02psyf15_pf3_1283':'Home care','p02psyf15_pf3_1280':'Nurse','p02psyf15_pf3_1281':'Psychiatrist','p02psyf15_pf3_1293a_a1':'Cognitive behav. therapy','p02psyf15_pf3_1293a_a2':'Cognitive rehabilitation','p02psyf15_pf3_1293a_a3':'Creative therapy','p02psyf15_pf3_1293a_a4':'Daytime activities center','p02psyf15_pf3_1293a_a5':'Family intervention','p02psyf15_pf3_1293a_a6':'Peer group','p02psyf15_pf3_1293a_a7':'Psycho education','p02psyf15_pf3_1293a_a8':'Social skills training','p02psyf15_pf3_1293a_a9':'Loss processing','p02psyf15_pf3_1293a_a10':'General rehabilitation','p02psyf15_pf3_1293a_a16':'Lifestyle intervention','p02psyf15_pf3_1293a_a11':'Occupational rehab.','p02psyf15_pf3_1293a_a12':'Dealing with addiction','p02psyf15_pf3_1293a_a13':'Financial support','p02psyf15_pf3_1293a_a14':'Libermanmodule','p02psyf15_pf3_1293a_a15':'Stressmanagement','p02psyf15_pf3_1293a_a17':'Fitness/PMT','p02psyf15_pf3_1293a_a18':'GP for psych. problems','p02psyf15_pf3_1293a_a19':'GP for phys. problems','p02psyf15_pf3_1293a_a20':'Dentist'})
df_p02psyf16 = df_p02psyf16.rename(columns={'p02psyf16_date': 'Date','p02psyf16_pf2_1288':'psych complaint-free','p02psyf16_pf2_1289':'Psychosis','p02psyf16_pf2_1290':'Readmission','p02psyf16_pf2_1291':'Suicide attempt','p02psyf16_pf2_1292':'Judicial contacts','p02psyf16_pf2_208':'Ambulatory or inpatient','p02psyf16_pf2_212':'Education level','p02psyf16_pf2_210':'Living situation','p02psyf16_pf2_209_a7':'No legal measure','p02psyf16_pf2_209_a2':'Judicial authorization','p02psyf16_pf2_209_a3':'Detention','p02psyf16_pf2_209_a4':'Coercive treatment','p02psyf16_pf2_209_a5':'Observation','p02psyf16_pf2_209_a8':'TBS','p02psyf16_pf2_1298':'Paid work','p02psyf16_pf2_1299':'Protected work','p02psyf16_pf2_1300':'Voluntary work','p02psyf16_pf2_1301':'Study','p02psyf16_pf2_1302':'Household chores','p02psyf16_pf2_1305':'No daytime activities','p02psyf16_pf3_224':'Refused care','p02psyf16_pf3_1283':'Home care','p02psyf16_pf3_1280':'Nurse','p02psyf16_pf3_1281':'Psychiatrist','p02psyf16_pf3_1293a_a1':'Cognitive behav. therapy','p02psyf16_pf3_1293a_a2':'Cognitive rehabilitation','p02psyf16_pf3_1293a_a3':'Creative therapy','p02psyf16_pf3_1293a_a4':'Daytime activities center','p02psyf16_pf3_1293a_a5':'Family intervention','p02psyf16_pf3_1293a_a6':'Peer group','p02psyf16_pf3_1293a_a7':'Psycho education','p02psyf16_pf3_1293a_a8':'Social skills training','p02psyf16_pf3_1293a_a9':'Loss processing','p02psyf16_pf3_1293a_a10':'General rehabilitation','p02psyf16_pf3_1293a_a16':'Lifestyle intervention','p02psyf16_pf3_1293a_a11':'Occupational rehab.','p02psyf16_pf3_1293a_a12':'Dealing with addiction','p02psyf16_pf3_1293a_a13':'Financial support','p02psyf16_pf3_1293a_a14':'Libermanmodule','p02psyf16_pf3_1293a_a15':'Stressmanagement','p02psyf16_pf3_1293a_a17':'Fitness/PMT','p02psyf16_pf3_1295':'GP for psych. problems','p02psyf16_pf3_1296':'GP for phys. problems','p02psyf16_pf3_1297':'Dentist'})
df_p02psyf18 = df_p02psyf18.rename(columns={'p02psyf18_date': 'Date','p02psyf18_pf2_1288':'psych complaint-free','p02psyf18_pf2_1289':'Psychosis','p02psyf18_pf2_1290':'Readmission','p02psyf18_pf2_1291':'Suicide attempt','p02psyf18_pf2_1292':'Judicial contacts','p02psyf18_pf2_208':'Ambulatory or inpatient','p02psyf18_pf2_212':'Education level','p02psyf18_pf2_210':'Living situation','p02psyf18_pf2_209_a7':'No legal measure','p02psyf18_pf2_209_a2':'Judicial authorization','p02psyf18_pf2_209_a3':'Detention','p02psyf18_pf2_209_a4':'Coercive treatment','p02psyf18_pf2_209_a5':'Observation','p02psyf18_pf2_209_a8':'TBS','p02psyf18_pf2_1298':'Paid work','p02psyf18_pf2_1299':'Protected work','p02psyf18_pf2_1300':'Voluntary work','p02psyf18_pf2_1301':'Study','p02psyf18_pf2_1305':'No daytime activities','p02psyf18_pf3_224':'Refused care','p02psyf18_pf3_1283':'Home care','p02psyf18_pf3_1280':'Nurse','p02psyf18_pf3_1281':'Psychiatrist','p02psyf18_pf3_1293a_a1':'Cognitive behav. therapy','p02psyf18_pf3_1293a_a2':'Cognitive rehabilitation','p02psyf18_pf3_1293a_a3':'Creative therapy','p02psyf18_pf3_1293a_a4':'Daytime activities center','p02psyf18_pf3_1293a_a5':'Family intervention','p02psyf18_pf3_1293a_a6':'Peer group','p02psyf18_pf3_1293a_a7':'Psycho education','p02psyf18_pf3_1293a_a8':'Social skills training','p02psyf18_pf3_1293a_a9':'Loss processing','p02psyf18_pf3_1293a_a10':'General rehabilitation','p02psyf18_pf3_1293a_a16':'Lifestyle intervention','p02psyf18_pf3_1293a_a11':'Occupational rehab.','p02psyf18_pf3_1293a_a12':'Dealing with addiction','p02psyf18_pf3_1293a_a13':'Financial support','p02psyf18_pf3_1293a_a14':'Libermanmodule','p02psyf18_pf3_1293a_a15':'Stressmanagement','p02psyf18_pf3_1293a_a17':'Fitness/PMT','p02psyf18_pf3_1295':'GP for psych. problems','p02psyf18_pf3_1296':'GP for phys. problems','p02psyf18_pf3_1297':'Dentist'})
df_p02psyf19 = df_p02psyf19.rename(columns={'p02psyf19_date': 'Date','p02psyf19_pf2_1288':'psych complaint-free','p02psyf19_pf2_1289':'Psychosis','p02psyf19_pf2_1290':'Readmission','p02psyf19_pf2_1291':'Suicide attempt','p02psyf19_pf2_1292':'Judicial contacts','p02psyf19_pf2_208':'Ambulatory or inpatient','p02psyf19_pf2_212':'Education level','p02psyf19_pf2_210':'Living situation','p02psyf19_pf2_209_a7':'No legal measure','p02psyf19_pf2_209_a2':'Judicial authorization','p02psyf19_pf2_209_a3':'Detention','p02psyf19_pf2_209_a4':'Coercive treatment','p02psyf19_pf2_209_a5':'Observation','p02psyf19_pf2_209_a8':'TBS','p02psyf19_pf2_1298':'Paid work','p02psyf19_pf2_1299':'Protected work','p02psyf19_pf2_1300':'Voluntary work','p02psyf19_pf2_1301':'Study','p02psyf19_pf2_1302':'Household chores','p02psyf19_pf2_1305':'No daytime activities','p02psyf19_pf3_224':'Refused care','p02psyf19_pf3_1283':'Home care','p02psyf19_pf3_1280':'Nurse','p02psyf19_pf3_1281':'Psychiatrist','p02psyf19_pf3_1293a_a1':'Cognitive behav. therapy','p02psyf19_pf3_1293a_a2':'Cognitive rehabilitation','p02psyf19_pf3_1293a_a3':'Creative therapy','p02psyf19_pf3_1293a_a4':'Daytime activities center','p02psyf19_pf3_1293a_a5':'Family intervention','p02psyf19_pf3_1293a_a6':'Peer group','p02psyf19_pf3_1293a_a7':'Psycho education','p02psyf19_pf3_1293a_a8':'Social skills training','p02psyf19_pf3_1293a_a9':'Loss processing','p02psyf19_pf3_1293a_a10':'General rehabilitation','p02psyf19_pf3_1293a_a16':'Lifestyle intervention','p02psyf19_pf3_1293a_a11':'Occupational rehab.','p02psyf19_pf3_1293a_a12':'Dealing with addiction','p02psyf19_pf3_1293a_a13':'Financial support','p02psyf19_pf3_1293a_a14':'Libermanmodule','p02psyf19_pf3_1293a_a15':'Stressmanagement','p02psyf19_pf3_1293a_a17':'Fitness/PMT','p02psyf19_pf3_1293a_a22':'Domestic help','p02psyf19_pf3_1293a_a23':'TMS','p02psyf19_pf3_1293a_a24':'ECT','p02psyf19_pf3_1293a_a25':'VR','p02psyf19_pf3_1293a_a26':'EMDR','p02psyf19_pf3_1293a_a27':'Mindfulness','p02psyf19_pf3_1293a_a28':'Acupuncture','p02psyf19_pf3_1295':'GP for psych. problems','p02psyf19_pf3_1296':'GP for phys. problems','p02psyf19_pf3_1297':'Dentist'})
df_p02psyf20 = df_p02psyf20.rename(columns={'p02psyf20_date': 'Date','p02psyf20_pf2_1288':'psych complaint-free','p02psyf20_pf2_1289':'Psychosis','p02psyf20_pf2_1290':'Readmission','p02psyf20_pf2_1291':'Suicide attempt','p02psyf20_pf2_1292':'Judicial contacts','p02psyf20_pf2_208':'Ambulatory or inpatient','p02psyf20_pf2_212':'Education level','p02psyf20_80':'Living situation','p02psyf20_pf2_209_a7':'No legal measure','p02psyf20_pf2_209_a2':'Judicial authorization','p02psyf20_pf2_209_a3':'Detention','p02psyf20_pf2_209_a4':'Coercive treatment','p02psyf20_pf2_209_a5':'Observation','p02psyf20_pf2_209_a8':'TBS','p02psyf20_pf2_1307_a8':'Paid work','p02psyf20_pf2_1307_a5':'Protected work','p02psyf20_pf2_1307_a4':'Voluntary work','p02psyf20_pf2_1307_a2':'Study','p02psyf20_12_a8':'Household chores','p02psyf20_12_a0':'No daytime activities','p02psyf20_pf3_224':'Refused care','p02psyf20_pf3_1283':'Home care','p02psyf20_pf3_1280':'Nurse','p02psyf20_pf3_1281':'Psychiatrist','p02psyf20_pf3_1293a_a1':'Cognitive behav. therapy','p02psyf20_pf3_1293a_a2':'Cognitive rehabilitation','p02psyf20_pf3_1293a_a3':'Creative therapy','p02psyf20_pf3_1293a_a4':'Daytime activities center','p02psyf20_pf3_1293a_a5':'Family intervention','p02psyf20_pf3_1293a_a6':'Peer group','p02psyf20_pf3_1293a_a7':'Psycho education','p02psyf20_pf3_1293a_a8':'Social skills training','p02psyf20_pf3_1293a_a9':'Loss processing','p02psyf20_pf3_1293a_a10':'General rehabilitation','p02psyf20_pf3_1293a_a16':'Lifestyle intervention','p02psyf20_pf3_1293a_a11':'Occupational rehab.','p02psyf20_pf3_1293a_a12':'Dealing with addiction','p02psyf20_pf3_1293a_a13':'Financial support','p02psyf20_pf3_1293a_a14':'Libermanmodule','p02psyf20_pf3_1293a_a15':'Stressmanagement','p02psyf20_pf3_1293a_a17':'Fitness/PMT','p02psyf20_pf3_1295':'GP for psych. problems','p02psyf20_pf3_1296':'GP for phys. problems','p02psyf20_pf3_1297':'Dentist','p02psyf20_pf3_1293a_a22':'Domestic help','p02psyf20_pf3_1293a_a23':'TMS','p02psyf20_pf3_1293a_a24':'ECT','p02psyf20_pf3_1293a_a25':'VR','p02psyf20_pf3_1293a_a26':'EMDR','p02psyf20_pf3_1293a_a27':'Mindfulness','p02psyf20_pf3_1293a_a28':'Acupuncture'})

# Sorting data to only keep first measurements available for every patient_id
df_p02psyf13['Date']= pd.to_datetime(df_p02psyf13['Date'], format='%d-%m-%Y %H:%M:%S')
df_p02psyf13 = df_p02psyf13.sort_values(by="Date") 
df_p02psyf13 = df_p02psyf13.drop_duplicates("patient_id", keep='first')
df_p02psyf14['Date']= pd.to_datetime(df_p02psyf14['Date'], format='%d-%m-%Y %H:%M:%S')
df_p02psyf14 = df_p02psyf14.sort_values(by="Date") 
df_p02psyf14 = df_p02psyf14.drop_duplicates("patient_id", keep='first')
df_p02psyf15['Date']= pd.to_datetime(df_p02psyf15['Date'], format='%d-%m-%Y %H:%M:%S')
df_p02psyf15 = df_p02psyf15.sort_values(by="Date") 
df_p02psyf15 = df_p02psyf15.drop_duplicates("patient_id", keep='first')
df_p02psyf16['Date']= pd.to_datetime(df_p02psyf16['Date'], format='%d-%m-%Y %H:%M:%S')
df_p02psyf16 = df_p02psyf16.sort_values(by="Date") 
df_p02psyf16 = df_p02psyf16.drop_duplicates("patient_id", keep='first')
df_p02psyf18['Date']= pd.to_datetime(df_p02psyf18['Date'], format='%d-%m-%Y %H:%M:%S')
df_p02psyf18 = df_p02psyf18.sort_values(by="Date") 
df_p02psyf18 = df_p02psyf18.drop_duplicates("patient_id", keep='first')
df_p02psyf19['Date']= pd.to_datetime(df_p02psyf19['Date'], format='%d-%m-%Y %H:%M:%S')
df_p02psyf19 = df_p02psyf19.sort_values(by="Date") 
df_p02psyf19 = df_p02psyf19.drop_duplicates("patient_id", keep='first')
df_p02psyf20['Date']= pd.to_datetime(df_p02psyf20['Date'], format='%d-%m-%Y %H:%M:%S')
df_p02psyf20 = df_p02psyf20.sort_values(by="Date") 
df_p02psyf20 = df_p02psyf20.drop_duplicates("patient_id", keep='first')

# Merge individual data frames to create one resulting data frame including data from all files 
df_p02psyf_merge = df_p02psyf13.merge(df_p02psyf14, on='patient_id', how='outer', suffixes=('13', '14'))
df_p02psyf_merge = df_p02psyf_merge.merge(df_p02psyf15, on='patient_id', how='outer', suffixes=('', '15'))
df_p02psyf_merge = df_p02psyf_merge.merge(df_p02psyf16, on='patient_id', how='outer', suffixes=('15', '16'))
df_p02psyf_merge = df_p02psyf_merge.merge(df_p02psyf18, on='patient_id', how='outer', suffixes=('16', '18'))
df_p02psyf_merge = df_p02psyf_merge.merge(df_p02psyf19, on='patient_id', how='outer', suffixes=('18', '19'))
df_p02psyf_merge = df_p02psyf_merge.merge(df_p02psyf20, on='patient_id', how='outer', suffixes=('19', '20'))
df_p02psyf_merger = df_p02psyf_merge.replace('>', '', regex=True).replace('<', '', regex=True)

# Only keep the first measurement available which is not NaN 
df_p02psyf_merger["Psych_complaint_free_all"] = df_p02psyf_merger.apply(lambda x: replace_missing2(x['psych complaint-free13'], x["psych complaint-free14"]), axis = 1)
df_p02psyf_merger["Psychosis_all"] = df_p02psyf_merger.apply(lambda x: replace_missing6(x['Psychosis13'], x["Psychosis14"], x['Psychosis15'], x["Psychosis16"], x["Psychosis18"],x["Psychosis19"]), axis = 1)
df_p02psyf_merger["Readmission_all"] = df_p02psyf_merger.apply(lambda x: replace_missing6(x['Readmission13'], x["Readmission14"], x['Readmission15'], x["Readmission16"], x["Readmission18"],x["Readmission19"]), axis = 1)
df_p02psyf_merger["Suicide_attempt_all"] = df_p02psyf_merger.apply(lambda x: replace_missing6(x['Suicide attempt13'], x["Suicide attempt14"], x['Suicide attempt15'], x["Suicide attempt16"], x["Suicide attempt18"],x["Suicide attempt19"]), axis = 1)
df_p02psyf_merger["Judicial_contacts_all"] = df_p02psyf_merger.apply(lambda x: replace_missing(x['Judicial contacts'], x['p02psyf15_pf2_209a'], x['p02psyf16_pf2_209a'], x['p02psyf18_pf2_209a'], x['p02psyf19_pf2_209a']), axis = 1)
df_p02psyf_merger["Living_situation_all"] = df_p02psyf_merger.apply(lambda x: replace_missing6(x['Living situation13'], x["Living situation14"], x['Living situation15'], x["Living situation16"], x["Living situation18"], x["Living situation19"]), axis = 1)
df_p02psyf_merger["Education_level_all"] = df_p02psyf_merger.apply(lambda x: replace_missing4(x['Education level15'], x["Education level16"], x["Education level18"],x["Education level19"]), axis = 1)
df_p02psyf_merger['Legal_measure_all'] = df_p02psyf_merger["Legal measure"]
df_p02psyf_merger["Paid_work_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Paid work13'], x["Paid work14"], x['Paid work15'], x["Paid work16"], x["Paid work18"],x["Paid work19"],x["Paid work"]), axis = 1)
df_p02psyf_merger["Protected_work_all"] = df_p02psyf_merger.apply(lambda x: replace_missing6(x['Protected work13'], x["Protected work14"], x['Protected work15'], x["Protected work16"], x["Protected work18"],x["Protected work19"]), axis = 1)
df_p02psyf_merger["Voluntary_work_all"] = df_p02psyf_merger.apply(lambda x: replace_missing6(x['Voluntary work13'], x["Voluntary work14"], x['Voluntary work15'], x["Voluntary work16"], x["Voluntary work18"],x["Voluntary work19"]), axis = 1)
df_p02psyf_merger["Study_all"] = df_p02psyf_merger.apply(lambda x: replace_missing6(x['Study13'], x["Study14"], x['Study15'], x["Study16"], x["Study18"],x["Study19"]), axis = 1)
df_p02psyf_merger["Household_chores_all"] = df_p02psyf_merger.apply(lambda x: replace_missing4(x['Household chores13'], x["Household chores14"], x['Household chores15'], x["Household chores16"]), axis = 1)
df_p02psyf_merger["No_daytime_activities_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['No daytime activities13'], x["No daytime activities14"], x['No daytime activities15'], x["No daytime activities16"], x["No daytime activities18"],x["No daytime activities19"],x["No daytime activities"]), axis = 1)
df_p02psyf_merger["Ambulatory_or_inpatient_all"] = df_p02psyf_merger.apply(lambda x: replace_missing2(x['Ambulatory or inpatient13'], x["Ambulatory or inpatient14"]), axis = 1)
df_p02psyf_merger["Refused_care_all"] = df_p02psyf_merger.apply(lambda x: replace_missing(x['Refused care13'], x["Refused care14"], x['Refused care15'], x["Refused care16"],x["Refused care"]), axis = 1)
df_p02psyf_merger["Home_care_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Home care13'], x["Home care14"], x['Home care15'], x["Home care16"], x["Home care18"],x["Home care19"],x["Home care"]), axis = 1)
df_p02psyf_merger["Nurse_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Nurse13'], x["Nurse14"], x['Nurse15'], x["Nurse16"], x["Nurse18"],x["Nurse19"],x["Nurse"]), axis = 1)
df_p02psyf_merger["Psychiatrist_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Psychiatrist13'], x["Psychiatrist14"], x['Psychiatrist15'], x["Psychiatrist16"], x["Psychiatrist18"],x["Psychiatrist19"],x["Psychiatrist"]), axis = 1)
df_p02psyf_merger["GP_for_psych_problems_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['GP for psych. problems13'], x["GP for psych. problems14"], x['GP for psych. problems15'], x["GP for psych. problems16"], x["GP for psych. problems18"],x["GP for psych. problems19"],x["GP for psych. problems"]), axis = 1)
df_p02psyf_merger["GP_for_phys_problems_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['GP for phys. problems13'], x["GP for phys. problems14"], x['GP for phys. problems15'], x["GP for phys. problems16"], x["GP for phys. problems18"],x["GP for phys. problems19"],x["GP for phys. problems"]), axis = 1)
df_p02psyf_merger["Dentist_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Dentist13'], x["Dentist14"], x['Nurse15'], x["Dentist16"], x["Dentist18"],x["Dentist19"],x["Dentist"]), axis = 1)
df_p02psyf_merger["Cognitive_behav_therapy_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Cognitive behav. therapy13'], x["Cognitive behav. therapy14"], x['Cognitive behav. therapy15'], x["Cognitive behav. therapy16"], x["Cognitive behav. therapy18"],x["Cognitive behav. therapy19"],x["Cognitive behav. therapy"]), axis = 1)
df_p02psyf_merger["Cognitive_rehabilitation_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Cognitive rehabilitation13'], x["Cognitive rehabilitation14"], x['Cognitive rehabilitation15'], x["Cognitive rehabilitation16"], x["Cognitive rehabilitation18"],x["Cognitive rehabilitation19"],x["Cognitive rehabilitation"]), axis = 1)
df_p02psyf_merger["Creative_therapy_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Creative therapy13'], x["Creative therapy14"], x['Creative therapy15'], x["Creative therapy16"], x["Creative therapy18"],x["Creative therapy19"],x["Creative therapy"]), axis = 1)
df_p02psyf_merger["Daytime_activities_center_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Daytime activities center13'], x["Daytime activities center14"], x['Daytime activities center15'], x["Daytime activities center16"], x["Daytime activities center18"],x["Daytime activities center19"],x["Daytime activities center"]), axis = 1)
df_p02psyf_merger["Family_intervention_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Family intervention13'], x["Family intervention14"], x['Family intervention15'], x["Family intervention16"], x["Family intervention18"],x["Family intervention19"],x["Family intervention"]), axis = 1)
df_p02psyf_merger["Peer_group_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Peer group13'], x["Peer group14"], x['Peer group15'], x["Peer group16"], x["Peer group18"],x["Peer group19"],x["Peer group"]), axis = 1)
df_p02psyf_merger["Psycho_education_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Psycho education13'], x["Psycho education14"], x['Psycho education15'], x["Psycho education16"], x["Psycho education18"],x["Psycho education19"],x["Psycho education"]), axis = 1)
df_p02psyf_merger["Social_skills_training_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Social skills training13'], x["Social skills training14"], x['Social skills training15'], x["Social skills training16"], x["Social skills training18"],x["Social skills training19"],x["Social skills training"]), axis = 1)
df_p02psyf_merger["Loss_processing_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Loss processing13'], x["Loss processing14"], x['Loss processing15'], x["Loss processing16"], x["Loss processing18"],x["Loss processing19"],x["Loss processing"]), axis = 1)
df_p02psyf_merger["General_rehabilitation_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['General rehabilitation13'], x["General rehabilitation14"], x['General rehabilitation15'], x["General rehabilitation16"], x["General rehabilitation18"],x["General rehabilitation19"],x["General rehabilitation"]), axis = 1)
df_p02psyf_merger["Occupational_rehab_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Occupational rehab.13'], x["Occupational rehab.14"], x['Occupational rehab.15'], x["Occupational rehab.16"], x["Occupational rehab.18"],x["Occupational rehab.19"],x["Occupational rehab."]), axis = 1)
df_p02psyf_merger["Dealing_with_addiction_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Dealing with addiction13'], x["Dealing with addiction14"], x['Dealing with addiction15'], x["Dealing with addiction16"], x["Dealing with addiction18"],x["Dealing with addiction19"],x["Dealing with addiction"]), axis = 1)
df_p02psyf_merger["Financial_support_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Financial support13'], x["Financial support14"], x['Financial support15'], x["Financial support16"], x["Financial support18"],x["Financial support19"],x["Financial support"]), axis = 1)
df_p02psyf_merger["Libermanmodule_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Libermanmodule13'], x["Libermanmodule14"], x['Libermanmodule15'], x["Libermanmodule16"], x["Libermanmodule18"],x["Libermanmodule19"],x["Libermanmodule"]), axis = 1)
df_p02psyf_merger["Stressmanagement_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Stressmanagement13'], x["Stressmanagement14"], x['Stressmanagement15'], x["Stressmanagement16"], x["Stressmanagement18"],x["Stressmanagement19"],x["Stressmanagement"]), axis = 1)
df_p02psyf_merger["Lifestyle_intervention_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Lifestyle intervention13'], x["Lifestyle intervention14"], x['Lifestyle intervention15'], x["Lifestyle intervention16"], x["Lifestyle intervention18"],x["Lifestyle intervention19"],x["Lifestyle intervention"]), axis = 1)
df_p02psyf_merger["Fitness/PMT_all"] = df_p02psyf_merger.apply(lambda x: replace_missing7(x['Fitness/PMT13'], x["Fitness/PMT14"], x['Fitness/PMT15'], x["Fitness/PMT16"], x["Fitness/PMT18"],x["Fitness/PMT19"],x["Fitness/PMT"]), axis = 1)
df_p02psyf_merger["Domestic_help_all"] = df_p02psyf_merger.apply(lambda x: replace_missing2(x["Domestic help19"],x["Domestic help20"]), axis = 1)
df_p02psyf_merger["TMS_all"] = df_p02psyf_merger.apply(lambda x: replace_missing2(x["TMS19"],x["TMS20"]), axis = 1)
df_p02psyf_merger["ECT_all"] = df_p02psyf_merger.apply(lambda x: replace_missing2(x["ECT19"],x["ECT20"]), axis = 1)
df_p02psyf_merger["VR_all"] = df_p02psyf_merger.apply(lambda x: replace_missing2(x["VR19"],x["VR20"]), axis = 1)
df_p02psyf_merger["EMDR_all"] = df_p02psyf_merger.apply(lambda x: replace_missing2(x["EMDR19"],x["EMDR20"]), axis = 1)
df_p02psyf_merger["Mindfulness_all"] = df_p02psyf_merger.apply(lambda x: replace_missing2(x["Mindfulness19"],x["Mindfulness20"]), axis = 1)
df_p02psyf_merger["Acupuncture_all"] = df_p02psyf_merger.apply(lambda x: replace_missing2(x["Acupuncture19"],x["Acupuncture20"]), axis = 1)
df_p02psyf_merger["Financial_support_all"] = df_p02psyf_merger.apply(lambda x: replace_missing2(x["Financial support19"],x["Financial support"]), axis = 1)

#Keep only combined columns
df_p02psyf = df_p02psyf_merger[['patient_id','Psych_complaint_free_all','Psychosis_all','Readmission_all','Suicide_attempt_all','Judicial_contacts_all','Living_situation_all','Education_level_all','Legal_measure_all','Paid_work_all','Protected_work_all','Voluntary_work_all','Study_all','Household_chores_all','No_daytime_activities_all','Ambulatory_or_inpatient_all','Refused_care_all','Home_care_all','Nurse_all','Psychiatrist_all','GP_for_psych_problems_all','GP_for_phys_problems_all','Dentist_all','Cognitive_behav_therapy_all','Cognitive_rehabilitation_all','Creative_therapy_all','Daytime_activities_center_all','Family_intervention_all','Peer_group_all','Psycho_education_all','Social_skills_training_all','Loss_processing_all','General_rehabilitation_all','Occupational_rehab_all','Dealing_with_addiction_all','Financial_support_all','Libermanmodule_all','Stressmanagement_all','Lifestyle_intervention_all','Fitness/PMT_all','Domestic_help_all','TMS_all','ECT_all','VR_all','EMDR_all','Mindfulness_all','Acupuncture_all','Financial_support_all']]

#Create a file containing the relevant variables 
df_p02psyf.to_csv('df_p02psyf.csv')
